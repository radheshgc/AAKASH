<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>recvmmsg(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="recvmmsg(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry" title="recvmmsg(2) — Linux manual pages">
    <a id="recvmmsg.2" name="recvmmsg.2" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>recvmmsg — receive multiple messages on a socket</p>
    </div>

    <div class="refsynopsisdiv" title="Synopsis">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#define _GNU_SOURCE
#include &lt;sys/socket.h&gt;
</pre>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>recvmmsg</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">sockfd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct mmsghdr *<var class="pdparam">msgvec</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned int <var class="pdparam">vlen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned int <var class="pdparam">flags</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct timespec *<var class="pdparam">timeout</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>

    <div class="refsect1" title="DESCRIPTION">
      <a id="recvmmsg-2_sect1" name="recvmmsg-2_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The <code class="function">recvmmsg</code>() system call
      is an extension of <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a> that allows the
      caller to receive multiple messages from a socket using a
      single system call. (This has performance benefits for some
      applications.) A further extension over <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a> is support for a
      timeout on the receive operation.</p>

      <p>The <em class="parameter"><code>sockfd</code></em>
      argument is the file descriptor of the socket to receive data
      from.</p>

      <p>The <em class="parameter"><code>msgvec</code></em>
      argument is a pointer to an array of <span class="structname">mmsghdr</span> structures. The size of this
      array is specified in <em class="parameter"><code>vlen</code></em>.</p>

      <p>The <span class="structname">mmsghdr</span> structure is
      defined in <code class="literal">&lt;</code><code class="filename">sys/socket.h</code><code class="literal">&gt;</code> as:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>

              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>

                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">mmsghdr</span> {</td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">struct msghdr</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_hdr</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* Message header */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned int</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_len</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Number of received bytes for header */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>

      <p>The <em class="parameter"><code>msg_hdr</code></em> field
      is a <em class="replaceable"><code>msghdr</code></em>
      structure, as described in <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a>. The <em class="parameter"><code>msg_len</code></em> field is the number of
      bytes returned for the message in the entry. This field has
      the same value as the return value of a single <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a> on the
      header.</p>

      <p>The <em class="parameter"><code>flags</code></em> argument
      contains flags ORed together. The flags are the same as
      documented for <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a>, with the
      following addition:</p>

      <div class="variablelist">
        <dl>
          <dt><span class="term"><code class="constant">MSG_WAITFORONE</code></span></dt>

          <dd>
            <p>Turns on <code class="constant">MSG_DONTWAIT</code>
            after the first message has been received.</p>
          </dd>
        </dl>
      </div>

      <p>The <em class="parameter"><code>timeout</code></em>
      argument points to a <span class="emphasis"><em>struct
      timespec</em></span> (see <a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_gettime</span>(2)</span></a>) defining
      a timeout (seconds plus nanoseconds) for the receive
      operation. (This interval will be rounded up to the system
      clock granularity, and kernel scheduling delays mean that the
      blocking interval may overrun by a small amount.) If
      <em class="parameter"><code>timeout</code></em> is
      <code class="constant">NULL</code> then the operation blocks
      indefinitely.</p>

      <p>A blocking <code class="function">recvmmsg</code>() call
      blocks until <em class="parameter"><code>vlen</code></em>
      messages have been received or until the timeout expires. A
      nonblocking call reads as many messages as are available (up
      to the limit specified by <em class="parameter"><code>vlen</code></em>) and returns
      immediately.</p>

      <p>On return from <code class="function">recvmmsg</code>(),
      successive elements of <em class="parameter"><code>msgvec</code></em> are updated to contain
      information about each received message: <em class="parameter"><code>msg_len</code></em> contains the size of
      the received message; the subfields of <em class="parameter"><code>msg_hdr</code></em> are updated as
      described in <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a>. The return
      value of the call indicates the number of elements of
      <em class="parameter"><code>msgvec</code></em> that have been
      updated.</p>
    </div>

    <div class="refsect1" title="RETURN VALUE">
      <a id="recvmmsg-2_sect2" name="recvmmsg-2_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On success, <code class="function">recvmmsg</code>()
      returns the number of messages received in <em class="parameter"><code>msgvec</code></em>; on error, −1 is
      returned, and <code class="varname">errno</code> is set to
      indicate the error.</p>
    </div>

    <div class="refsect1" title="ERRORS">
      <a id="recvmmsg-2_sect3" name="recvmmsg-2_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <p>Errors are as for <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a>. In addition,
      the following error can occur:</p>

      <div class="variablelist">
        <dl>
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p><em class="parameter"><code>timeout</code></em> is
            invalid.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1" title="VERSIONS">
      <a id="recvmmsg-2_sect4" name="recvmmsg-2_sect4" shape="rect"> </a>

      <h2>VERSIONS</h2>

      <p>The <code class="function">recvmmsg</code>() system call
      was added in Linux 2.6.32. Support in glibc was added in
      version 2.12.</p>
    </div>

    <div class="refsect1" title="CONFORMING TO">
      <a id="recvmmsg-2_sect5" name="recvmmsg-2_sect5" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p><code class="function">recvmmsg</code>() is
      Linux-specific.</p>
    </div>

    <div class="refsect1" title="SEE ALSO">
      <a id="recvmmsg-2_sect6" name="recvmmsg-2_sect6" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_gettime</span>(2)</span></a>, <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmsg</span>(2)</span></a>, <a class="link" href="../htmlman2/sendmmsg.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sendmmsg</span>(2)</span></a>, <a class="link" href="../htmlman2/send.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sendmsg</span>(2)</span></a>, <a class="link" href="../htmlman2/socket.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(2)</span></a>, <a class="link" href="../htmlman7/socket.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(7)</span></a></p>
    </div>

    <div class="colophon" title="COLOPHON">
      <a id="recvmmsg-2_sect7" name="recvmmsg-2_sect7" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.41 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, and information about reporting
      bugs, can be found at
      http://www.kernel.org/doc/man-pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (C) 2011 by Andi Kleen &lt;andi<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>firstfloor.org&gt;<br />

                  and Copyright (c) 2011 by Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  <br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  <br />
                  FIXME: This page could be improved with an example program.<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
