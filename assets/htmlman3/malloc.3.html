<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>malloc(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="malloc(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="malloc.3" name="malloc.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>malloc, free, calloc, realloc — allocate and free
      dynamic memory</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;stdlib.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            *<strong>malloc</strong>(</code></td>

            <td rowspan="1" colspan="1">size_t <var class="pdparam">size</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            <strong>free</strong>(</code></td>

            <td rowspan="1" colspan="1">void *<var class="pdparam">ptr</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            *<strong>calloc</strong>(</code></td>

            <td rowspan="1" colspan="1">size_t <var class="pdparam">nmemb</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">size_t <var class="pdparam">size</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            *<strong>realloc</strong>(</code></td>

            <td rowspan="1" colspan="1">void *<var class="pdparam">ptr</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">size_t <var class="pdparam">size</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>

    <div class="refsect1">
      <a id="malloc-3_sect1" name="malloc-3_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The <code class="function">malloc</code>() function
      allocates <em class="parameter"><code>size</code></em> bytes
      and returns a pointer to the allocated memory. <span class="emphasis"><em>The memory is not initialized</em></span>. If
      <em class="parameter"><code>size</code></em> is 0, then
      <code class="function">malloc</code>() returns either NULL,
      or a unique pointer value that can later be successfully
      passed to <code class="function">free</code>().</p>

      <p>The <code class="function">free</code>() function frees
      the memory space pointed to by <em class="parameter"><code>ptr</code></em>, which must have been
      returned by a previous call to <code class="function">malloc</code>(), <code class="function">calloc</code>() or <code class="function">realloc</code>(). Otherwise, or if <em class="replaceable"><code>free(ptr)</code></em> has already been
      called before, undefined behavior occurs. If <em class="parameter"><code>ptr</code></em> is NULL, no operation is
      performed.</p>

      <p>The <code class="function">calloc</code>() function
      allocates memory for an array of <em class="parameter"><code>nmemb</code></em> elements of <em class="parameter"><code>size</code></em> bytes each and returns a
      pointer to the allocated memory. The memory is set to zero.
      If <em class="parameter"><code>nmemb</code></em> or
      <em class="parameter"><code>size</code></em> is 0, then
      <code class="function">calloc</code>() returns either NULL,
      or a unique pointer value that can later be successfully
      passed to <code class="function">free</code>().</p>

      <p>The <code class="function">realloc</code>() function
      changes the size of the memory block pointed to by <em class="parameter"><code>ptr</code></em> to <em class="parameter"><code>size</code></em> bytes. The contents will
      be unchanged in the range from the start of the region up to
      the minimum of the old and new sizes. If the new size is
      larger than the old size, the added memory will <span class="emphasis"><em>not</em></span> be initialized. If <em class="parameter"><code>ptr</code></em> is NULL, then the call is
      equivalent to <em class="replaceable"><code>malloc(size)</code></em>, for all values
      of <em class="parameter"><code>size</code></em>; if
      <em class="parameter"><code>size</code></em> is equal to
      zero, and <em class="parameter"><code>ptr</code></em> is not
      NULL, then the call is equivalent to <em class="replaceable"><code>free(ptr)</code></em>. Unless <em class="parameter"><code>ptr</code></em> is NULL, it must have been
      returned by an earlier call to <code class="function">malloc</code>(), <code class="function">calloc</code>() or <code class="function">realloc</code>(). If the area pointed to was
      moved, a <em class="replaceable"><code>free(ptr)</code></em>
      is done.</p>
    </div>

    <div class="refsect1">
      <a id="malloc-3_sect2" name="malloc-3_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>The <code class="function">malloc</code>() and
      <code class="function">calloc</code>() functions return a
      pointer to the allocated memory that is suitably aligned for
      any kind of variable. On error, these functions return NULL.
      NULL may also be returned by a successful call to
      <code class="function">malloc</code>() with a <em class="parameter"><code>size</code></em> of zero, or by a
      successful call to <code class="function">calloc</code>()
      with <em class="parameter"><code>nmemb</code></em> or
      <em class="parameter"><code>size</code></em> equal to
      zero.</p>

      <p>The <code class="function">free</code>() function returns
      no value.</p>

      <p>The <code class="function">realloc</code>() function
      returns a pointer to the newly allocated memory, which is
      suitably aligned for any kind of variable and may be
      different from <em class="parameter"><code>ptr</code></em>,
      or NULL if the request fails. If <em class="parameter"><code>size</code></em> was equal to 0, either
      NULL or a pointer suitable to be passed to <code class="function">free</code>() is returned. If <code class="function">realloc</code>() fails the original block is left
      untouched; it is not freed or moved.</p>
    </div>

    <div class="refsect1">
      <a id="malloc-3_sect3" name="malloc-3_sect3" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>C89, C99.</p>
    </div>

    <div class="refsect1">
      <a id="malloc-3_sect4" name="malloc-3_sect4" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>By default, Linux follows an optimistic memory allocation
      strategy. This means that when <code class="function">malloc</code>() returns non-NULL there is no
      guarantee that the memory really is available. In case it
      turns out that the system is out of memory, one or more
      processes will be killed by the OOM killer. For more
      information, see the description of <code class="filename">/proc/sys/vm/overcommit_memory</code> and
      <code class="filename">/proc/sys/vm/oom_adj</code> in
      <a class="link" href="../htmlman5/proc.5.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">proc</span>(5)</span></a>, and the Linux
      kernel source file <code class="filename">Documentation/vm/overcommit-accounting</code>.</p>

      <p>Normally, <code class="function">malloc</code>() allocates
      memory from the heap, and adjusts the size of the heap as
      required, using <a class="link" href="../htmlman2/brk.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sbrk</span>(2)</span></a>. When allocating
      blocks of memory larger than <code class="constant">MMAP_THRESHOLD</code> bytes, the glibc
      <code class="function">malloc</code>() implementation
      allocates the memory as a private anonymous mapping using
      <a class="link" href="../htmlman2/mmap.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a>. <code class="constant">MMAP_THRESHOLD</code> is 128 kB by default, but is
      adjustable using <a class="link" href="../htmlman3/mallopt.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mallopt</span>(3)</span></a>. Allocations
      performed using <a class="link" href="../htmlman2/mmap.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a> are unaffected by
      the <code class="constant">RLIMIT_DATA</code> resource limit
      (see <a class="link" href="../htmlman2/getrlimit.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getrlimit</span>(2)</span></a>).</p>

      <p>To avoid corruption in multithreaded applications, mutexes
      are used internally to protect the memory-management data
      structures employed by these functions. In a multithreaded
      application in which threads simultaneously allocate and free
      memory, there could be contention for these mutexes. To
      scalably handle memory allocation in multithreaded
      applications, glibc creates additional <span class="emphasis"><em>memory allocation arenas</em></span> if mutex
      contention is detected. Each arena is a large region of
      memory that is internally allocated by the system (using
      <a class="link" href="../htmlman2/brk.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">brk</span>(2)</span></a> or <a class="link" href="../htmlman2/mmap.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a>), and managed with
      its own mutexes.</p>

      <p>The UNIX 98 standard requires <code class="function">malloc</code>(), <code class="function">calloc</code>(), and <code class="function">realloc</code>() to set <code class="varname">errno</code> to <span class="errorname">ENOMEM</span> upon failure. Glibc assumes that
      this is done (and the glibc versions of these routines do
      this); if you use a private malloc implementation that does
      not set <code class="varname">errno</code>, then certain
      library routines may fail without having a reason in
      <code class="varname">errno</code>.</p>

      <p>Crashes in <code class="function">malloc</code>(),
      <code class="function">calloc</code>(), <code class="function">realloc</code>(), or <code class="function">free</code>() are almost always related to heap
      corruption, such as overflowing an allocated chunk or freeing
      the same pointer twice.</p>

      <p>Recent versions of Linux libc (later than 5.4.23) and
      glibc (2.x) include a <code class="function">malloc</code>()
      implementation which is tunable via environment variables.
      For details, see <a class="link" href="../htmlman3/mallopt.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mallopt</span>(3)</span></a>.</p>
    </div>

    <div class="refsect1">
      <a id="malloc-3_sect5" name="malloc-3_sect5" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/brk.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">brk</span>(2)</span></a>, <a class="link" href="../htmlman2/mmap.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a>, <a class="link" href="../htmlman3/alloca.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">alloca</span>(3)</span></a>, <a class="link" href="../htmlman3/malloc_get_state.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">malloc_get_state</span>(3)</span></a>,
      <a class="link" href="../htmlman3/malloc_info.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">malloc_info</span>(3)</span></a>, <a class="link" href="../htmlman3/malloc_trim.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">malloc_trim</span>(3)</span></a>, <a class="link" href="../htmlman3/malloc_usable_size.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">malloc_usable_size</span>(3)</span></a>,
      <a class="link" href="../htmlman3/mallopt.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mallopt</span>(3)</span></a>, <a class="link" href="../htmlman3/mcheck.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mcheck</span>(3)</span></a>, <a class="link" href="../htmlman3/mtrace.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mtrace</span>(3)</span></a>, <a class="link" href="../htmlman3/posix_memalign.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">posix_memalign</span>(3)</span></a></p>
    </div>

    <div class="colophon">
      <a id="malloc-3_sect6" name="malloc-3_sect6" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.45 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, and information about reporting
      bugs, can be found at
      http://www.kernel.org/doc/man-pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 1993 by Thomas Koenig (ig25<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>rz.uni-karlsruhe.de)<br />

                  <br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  License.<br />
                  Modified Sat Jul 24 19:00:59 1993 by Rik Faith (faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu)<br />

                  Clarification concerning realloc, iwj10<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cus.cam.ac.uk (Ian Jackson), 950701<br />

                  Documented MALLOC_CHECK_, Wolfram Gloger (wmglo<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>dent.med.uni-muenchen.de)<br />

                  2007-09-15 mtk: added notes on malloc()'s use of sbrk() and mmap().<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
