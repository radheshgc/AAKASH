<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>fopen(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="fopen(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="fopen.3" name="fopen.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>fopen, fdopen, freopen — stream open functions</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;stdio.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">FILE
            *<strong>fopen</strong>(</code></td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">path</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">mode</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">FILE
            *<strong>fdopen</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">fd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">mode</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">FILE
            *<strong>freopen</strong>(</code></td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">path</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">mode</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">FILE *<var class="pdparam">stream</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">fdopen</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 1 || <code class="constant">_XOPEN_SOURCE</code> ||
                      <code class="constant">_POSIX_SOURCE</code></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="fopen-3_sect1" name="fopen-3_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The <code class="function">fopen</code>() function opens
      the file whose name is the string pointed to by <em class="parameter"><code>path</code></em> and associates a stream
      with it.</p>

      <p>The argument <em class="parameter"><code>mode</code></em>
      points to a string beginning with one of the following
      sequences (possibly followed by additional characters, as
      described below):</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="literal">r</code></span></dt>

          <dd>
            <p>Open text file for reading. The stream is positioned
            at the beginning of the file.</p>
          </dd>

          <dt><span class="term">r+</span></dt>

          <dd>
            <p>Open for reading and writing. The stream is
            positioned at the beginning of the file.</p>
          </dd>

          <dt><span class="term"><code class="literal">w</code></span></dt>

          <dd>
            <p>Truncate file to zero length or create text file for
            writing. The stream is positioned at the beginning of
            the file.</p>
          </dd>

          <dt><span class="term">w+</span></dt>

          <dd>
            <p>Open for reading and writing. The file is created if
            it does not exist, otherwise it is truncated. The
            stream is positioned at the beginning of the file.</p>
          </dd>

          <dt><span class="term"><code class="literal">a</code></span></dt>

          <dd>
            <p>Open for appending (writing at end of file). The
            file is created if it does not exist. The stream is
            positioned at the end of the file.</p>
          </dd>

          <dt><span class="term">a+</span></dt>

          <dd>
            <p>Open for reading and appending (writing at end of
            file). The file is created if it does not exist. The
            initial file position for reading is at the beginning
            of the file, but output is always appended to the end
            of the file.</p>
          </dd>
        </dl>
      </div>

      <p>The <em class="parameter"><code>mode</code></em> string
      can also include the letter 'b' either as a last character or
      as a character between the characters in any of the
      two-character strings described above. This is strictly for
      compatibility with C89 and has no effect; the 'b' is ignored
      on all POSIX conforming systems, including Linux. (Other
      systems may treat text files and binary files differently,
      and adding the 'b' may be a good idea if you do I/O to a
      binary file and expect that your program may be ported to
      non-UNIX environments.)</p>

      <p>See NOTES below for details of glibc extensions for
      <em class="parameter"><code>mode</code></em>.</p>

      <p>Any created files will have mode <code class="constant">S_IRUSR</code> | <code class="constant">S_IWUSR</code> | <code class="constant">S_IRGRP</code> | <code class="constant">S_IWGRP</code> | <code class="constant">S_IROTH</code> | <code class="constant">S_IWOTH</code> (0666), as modified by the
      process's umask value (see <a class="link" href="../htmlman2/umask.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">umask</span>(2)</span></a>).</p>

      <p>Reads and writes may be intermixed on read/write streams
      in any order. Note that ANSI C requires that a file
      positioning function intervene between output and input,
      unless an input operation encounters end-of-file. (If this
      condition is not met, then a read is allowed to return the
      result of writes other than the most recent.) Therefore it is
      good practice (and indeed sometimes necessary under Linux) to
      put an <a class="link" href="../htmlman3/fseek.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fseek</span>(3)</span></a> or <a class="link" href="../htmlman3/fseek.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fgetpos</span>(3)</span></a> operation
      between write and read operations on such a stream. This
      operation may be an apparent no-op (as in <span class="emphasis"><em>fseek(..., 0L, SEEK_CUR)</em></span> called
      for its synchronizing side effect.</p>

      <p>Opening a file in append mode (<code class="literal">a</code> as the first character of <em class="parameter"><code>mode</code></em>) causes all subsequent
      write operations to this stream to occur at end-of-file, as
      if preceded the call:</p>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
    fseek(stream, 0, SEEK_END);
</pre>
      </div>

      <p>The <code class="function">fdopen</code>() function
      associates a stream with the existing file descriptor,
      <em class="parameter"><code>fd</code></em>. The <em class="parameter"><code>mode</code></em> of the stream (one of the
      values "r", "r+", "w", "w+", "a", "a+") must be compatible
      with the mode of the file descriptor. The file position
      indicator of the new stream is set to that belonging to
      <em class="parameter"><code>fd</code></em>, and the error and
      end-of-file indicators are cleared. Modes "w" or "w+" do not
      cause truncation of the file. The file descriptor is not
      dup'ed, and will be closed when the stream created by
      <code class="function">fdopen</code>() is closed. The result
      of applying <code class="function">fdopen</code>() to a
      shared memory object is undefined.</p>

      <p>The <code class="function">freopen</code>() function opens
      the file whose name is the string pointed to by <em class="parameter"><code>path</code></em> and associates the stream
      pointed to by <em class="parameter"><code>stream</code></em>
      with it. The original stream (if it exists) is closed. The
      <em class="parameter"><code>mode</code></em> argument is used
      just as in the <code class="function">fopen</code>()
      function. The primary use of the <code class="function">freopen</code>() function is to change the file
      associated with a standard text stream (<code class="varname">stderr</code>, <code class="varname">stdin</code>,
      or <code class="varname">stdout</code>).</p>
    </div>

    <div class="refsect1">
      <a id="fopen-3_sect2" name="fopen-3_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>Upon successful completion <code class="function">fopen</code>(), <code class="function">fdopen</code>() and <code class="function">freopen</code>() return a <span class="type">FILE</span> pointer. Otherwise, NULL is returned and
      <code class="varname">errno</code> is set to indicate the
      error.</p>
    </div>

    <div class="refsect1">
      <a id="fopen-3_sect3" name="fopen-3_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p>The <em class="parameter"><code>mode</code></em>
            provided to <code class="function">fopen</code>(),
            <code class="function">fdopen</code>(), or <code class="function">freopen</code>() was invalid.</p>
          </dd>
        </dl>
      </div>

      <p>The <code class="function">fopen</code>(), <code class="function">fdopen</code>() and <code class="function">freopen</code>() functions may also fail and set
      <code class="varname">errno</code> for any of the errors
      specified for the routine <a class="link" href="../htmlman3/malloc.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">malloc</span>(3)</span></a>.</p>

      <p>The <code class="function">fopen</code>() function may
      also fail and set <code class="varname">errno</code> for any
      of the errors specified for the routine <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>.</p>

      <p>The <code class="function">fdopen</code>() function may
      also fail and set <code class="varname">errno</code> for any
      of the errors specified for the routine <a class="link" href="../htmlman2/fcntl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a>.</p>

      <p>The <code class="function">freopen</code>() function may
      also fail and set <code class="varname">errno</code> for any
      of the errors specified for the routines <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>, <a class="link" href="../htmlman3/fclose.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fclose</span>(3)</span></a> and <a class="link" href="../htmlman3/fflush.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fflush</span>(3)</span></a>.</p>
    </div>

    <div class="refsect1">
      <a id="fopen-3_sect4" name="fopen-3_sect4" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>The <code class="function">fopen</code>() and <code class="function">freopen</code>() functions conform to C89. The
      <code class="function">fdopen</code>() function conforms to
      POSIX.1-1990.</p>
    </div>

    <div class="refsect1">
      <a id="fopen-3_sect5" name="fopen-3_sect5" shape="rect"> </a>

      <h2>NOTES</h2>

      <div class="refsect2">
        <a id="fopen-3_sect6" name="fopen-3_sect6" shape="rect"> </a>

        <h3>Glibc Notes</h3>

        <p>The GNU C library allows the following extensions for
        the string specified in <em class="parameter"><code>mode</code></em>:</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><code class="literal">c</code>
            (since glibc 2.3.3)</span></dt>

            <dd>
              <p>Do not make the open operation, or subsequent read
              and write operations, thread cancellation points.
              This flag is ignored for <code class="function">fdopen</code>().</p>
            </dd>

            <dt><span class="term"><code class="literal">e</code>
            (since glibc 2.7)</span></dt>

            <dd>
              <p>Open the file with the <code class="constant">O_CLOEXEC</code> flag. See <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> for more
              information. This flag is ignored for <code class="function">fdopen</code>().</p>
            </dd>

            <dt><span class="term"><code class="literal">m</code>
            (since glibc 2.3)</span></dt>

            <dd>
              <p>Attempt to access the file using <a class="link" href="../htmlman2/mmap.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a>, rather
              than I/O system calls (<a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a>, <a class="link" href="../htmlman2/write.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">write</span>(2)</span></a>).
              Currently, use of <a class="link" href="../htmlman2/mmap.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a> is only
              attempted for a file opened for reading.</p>
            </dd>

            <dt><span class="term"><code class="literal">x</code></span></dt>

            <dd>
              <p>Open the file exclusively (like the <code class="constant">O_EXCL</code> flag of <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>). If the
              file already exists, <code class="function">fopen</code>() fails, and sets
              <code class="varname">errno</code> to <span class="errorname">EEXIST</span>. This flag is ignored for
              <code class="function">fdopen</code>().</p>
            </dd>
          </dl>
        </div>

        <p>In addition to the above characters, <code class="function">fopen</code>() and <code class="function">freopen</code>() support the following syntax in
        <em class="parameter"><code>mode</code></em>:</p>

        <p><span class="emphasis"><em>,ccs=</em></span><code class="function">string</code></p>

        <p>The given <code class="function">string</code> is taken
        as the name of a coded character set and the stream is
        marked as wide-oriented. Thereafter, internal conversion
        functions convert I/O to and from the character set
        <code class="function">string</code>. If the <em class="replaceable"><code>,ccs=</code></em><code class="function">string</code> syntax is not specified, then the
        wide-orientation of the stream is determined by the first
        file operation. If that operation is a wide-character
        operation, the stream is marked wide-oriented, and
        functions to convert to the coded character set are
        loaded.</p>
      </div>
    </div>

    <div class="refsect1">
      <a id="fopen-3_sect7" name="fopen-3_sect7" shape="rect"> </a>

      <h2>BUGS</h2>

      <p>When parsing for individual flag characters in <em class="parameter"><code>mode</code></em> (i.e., the characters
      preceding the "ccs" specification), the glibc implementation
      of <code class="function">fopen</code>() and <code class="function">freopen</code>() limits the number of characters
      examined in <em class="parameter"><code>mode</code></em> to 7
      (or, in glibc versions before 2.14, to 6, which was not
      enough to include possible specifications such as "rb+cmxe").
      The current implementation of <code class="function">fdopen</code>() parses at most 5 characters in
      <em class="parameter"><code>mode</code></em>.</p>
    </div>

    <div class="refsect1">
      <a id="fopen-3_sect8" name="fopen-3_sect8" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>, <a class="link" href="../htmlman3/fclose.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fclose</span>(3)</span></a>, <a class="link" href="../htmlman3/ferror.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fileno</span>(3)</span></a>, <a class="link" href="../htmlman3/fmemopen.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fmemopen</span>(3)</span></a>, <a class="link" href="../htmlman3/fopencookie.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fopencookie</span>(3)</span></a></p>
    </div>

    <div class="colophon">
      <a id="fopen-3_sect9" name="fopen-3_sect9" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.45 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, and information about reporting
      bugs, can be found at
      http://www.kernel.org/doc/man-pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 1990, 1991 The Regents of the University of California.<br />

                  All rights reserved.<br />
                  <br />
                  This code is derived from software contributed to Berkeley by<br />

                  Chris Torek and the American National Standards Committee X3,<br />

                  on Information Processing Systems.<br />

                  <br />
                  Redistribution and use in source and binary forms, with or without<br />

                  modification, are permitted provided that the following conditions<br />

                  are met:<br />
                  1. Redistributions of source code must retain the above copyright<br />

                     notice, this list of conditions and the following disclaimer.<br />

                  2. Redistributions in binary form must reproduce the above copyright<br />

                     notice, this list of conditions and the following disclaimer in the<br />

                     documentation and/or other materials provided with the distribution.<br />

                  3. All advertising materials mentioning features or use of this software<br />

                     must display the following acknowledgement:<br />

                  This product includes software developed by the University of<br />

                  California, Berkeley and its contributors.<br />

                  4. Neither the name of the University nor the names of its contributors<br />

                     may be used to endorse or promote products derived from this software<br />

                     without specific prior written permission.<br />

                  <br />
                  THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND<br />

                  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<br />

                  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<br />

                  ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE<br />

                  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br />

                  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS<br />

                  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)<br />

                  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br />

                  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY<br />

                  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF<br />

                  SUCH DAMAGE.<br />
                  <br />
                      <script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>(#)fopen.3
                  6.8 (Berkeley) 6/29/91<br />
                  <br />
                  Converted for Linux, Mon Nov 29 15:22:01 1993, faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu<br />

                  Modified, aeb, 960421, 970806<br />

                  Modified, joey, aeb, 2002-01-03<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
