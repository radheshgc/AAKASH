<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>btree(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="btree(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="btree.3" name="btree.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>btree — btree database access method</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;sys/types.h&gt;
#include &lt;db.h&gt;
  
</pre>
      </div>
    </div>

    <div class="refsect1">
      <a id="btree-3_sect1" name="btree-3_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p><span class="emphasis"><em>Note well</em></span>: This
      page documents interfaces provided in glibc up until version
      2.1. Since version 2.2, glibc no longer provides these
      interfaces. Probably, you are looking for the APIs provided
      by the <code class="function">libdb</code> library
      instead.</p>

      <p>The routine <a class="link" href="../htmlman3/dbopen.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dbopen</span>(3)</span></a> is the library
      interface to database files. One of the supported file
      formats is btree files. The general description of the
      database access methods is in <a class="link" href="../htmlman3/dbopen.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dbopen</span>(3)</span></a>, this manual page
      describes only the btree specific information. The btree data
      structure is a sorted, balanced tree structure storing
      associated key/data pairs. The btree access method specific
      data structure provided to <a class="link" href="../htmlman3/dbopen.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dbopen</span>(3)</span></a> is defined in the
      <code class="literal">&lt;</code><code class="filename">db.h</code><code class="literal">&gt;</code>
      include file as follows:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>

              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  typedef</td>

                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1">struct {</td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned long</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>flags</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned int</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>cachesize</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>maxkeypage</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>minkeypage</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned int</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>psize</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  (*</td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>compare</code></em>)(const DBT *key1, const DBT *key2);</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">size_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  (*</td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>prefix</code></em>)(const DBT *key1, const DBT *key2);</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>lorder</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1"> </td>
                </tr>

                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">} BTREEINFO;</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>

      <p>The elements of this structure are as follows:</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><em class="parameter"><code>flags</code></em></span></dt>

          <dd>
            <p>The flag value is specified by ORing any of the
            following values:</p>

            <div class="blockquote">
              <blockquote class="blockquote">
                <div class="variablelist">
                  <dl class="variablelist">
                    <dt><span class="term"><code class="constant">R_DUP</code></span></dt>

                    <dd>
                      <p>Permit duplicate keys in the tree, that
                      is, permit insertion if the key to be
                      inserted already exists in the tree. The
                      default behavior, as described in <a class="link" href="../htmlman3/dbopen.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dbopen</span>(3)</span></a>,
                      is to overwrite a matching key when inserting
                      a new key or to fail if the <code class="constant">R_NOOVERWRITE</code> flag is
                      specified. The <code class="constant">R_DUP</code> flag is overridden by
                      the <code class="constant">R_NOOVERWRITE</code> flag, and if
                      the <code class="constant">R_NOOVERWRITE</code> flag is
                      specified, attempts to insert duplicate keys
                      into the tree will fail.</p>

                      <p>If the database contains duplicate keys,
                      the order of retrieval of key/data pairs is
                      undefined if the <code class="function">get</code> routine is used,
                      however, <code class="function">seq</code>
                      routine calls with the <code class="constant">R_CURSOR</code> flag set will
                      always return the logical "first" of any
                      group of duplicate keys.</p>
                    </dd>
                  </dl>
                </div>
              </blockquote>
            </div>
          </dd>

          <dt><span class="term"><em class="parameter"><code>cachesize</code></em></span></dt>

          <dd>
            <p>A suggested maximum size (in bytes) of the memory
            cache. This value is <span class="emphasis"><em>only</em></span> advisory, and the
            access method will allocate more memory rather than
            fail. Since every search examines the root page of the
            tree, caching the most recently used pages
            substantially improves access time. In addition,
            physical writes are delayed as long as possible, so a
            moderate cache can reduce the number of I/O operations
            significantly. Obviously, using a cache increases (but
            only increases) the likelihood of corruption or lost
            data if the system crashes while a tree is being
            modified. If <em class="parameter"><code>cachesize</code></em> is 0 (no size
            is specified) a default cache is used.</p>
          </dd>

          <dt><span class="term"><em class="parameter"><code>maxkeypage</code></em></span></dt>

          <dd>
            <p>The maximum number of keys which will be stored on
            any single page. Not currently implemented.</p>
          </dd>

          <dt><span class="term"><em class="parameter"><code>minkeypage</code></em></span></dt>

          <dd>
            <p>The minimum number of keys which will be stored on
            any single page. This value is used to determine which
            keys will be stored on overflow pages, that is, if a
            key or data item is longer than the pagesize divided by
            the minkeypage value, it will be stored on overflow
            pages instead of in the page itself. If <em class="parameter"><code>minkeypage</code></em> is 0 (no
            minimum number of keys is specified) a value of 2 is
            used.</p>
          </dd>

          <dt><span class="term"><em class="parameter"><code>psize</code></em></span></dt>

          <dd>
            <p>Page size is the size (in bytes) of the pages used
            for nodes in the tree. The minimum page size is 512
            bytes and the maximum page size is 64K. If <em class="parameter"><code>psize</code></em> is 0 (no page size
            is specified) a page size is chosen based on the
            underlying file system I/O block size.</p>
          </dd>

          <dt><span class="term"><em class="parameter"><code>compare</code></em></span></dt>

          <dd>
            <p>Compare is the key comparison function. It must
            return an integer less than, equal to, or greater than
            zero if the first key argument is considered to be
            respectively less than, equal to, or greater than the
            second key argument. The same comparison function must
            be used on a given tree every time it is opened. If
            <em class="parameter"><code>compare</code></em> is NULL
            (no comparison function is specified), the keys are
            compared lexically, with shorter keys considered less
            than longer keys.</p>
          </dd>

          <dt><span class="term"><em class="parameter"><code>prefix</code></em></span></dt>

          <dd>
            <p>Prefix is the prefix comparison function. If
            specified, this routine must return the number of bytes
            of the second key argument which are necessary to
            determine that it is greater than the first key
            argument. If the keys are equal, the key length should
            be returned. Note, the usefulness of this routine is
            very data-dependent, but, in some data sets can produce
            significantly reduced tree sizes and search times. If
            <em class="parameter"><code>prefix</code></em> is NULL
            (no prefix function is specified), <span class="emphasis"><em>and</em></span> no comparison function
            is specified, a default lexical comparison routine is
            used. If <em class="parameter"><code>prefix</code></em>
            is NULL and a comparison routine is specified, no
            prefix comparison is done.</p>
          </dd>

          <dt><span class="term"><em class="parameter"><code>lorder</code></em></span></dt>

          <dd>
            <p>The byte order for integers in the stored database
            metadata. The number should represent the order as an
            integer; for example, big endian order would be the
            number 4,321. If <em class="parameter"><code>lorder</code></em> is 0 (no order is
            specified) the current host order is used. If the file
            already exists (and the <code class="constant">O_TRUNC</code> flag is not specified), the
            values specified for the arguments <em class="parameter"><code>flags</code></em>, <em class="parameter"><code>lorder</code></em> and <em class="parameter"><code>psize</code></em> are ignored in
            favor of the values used when the tree was created.
            Forward sequential scans of a tree are from the least
            key to the greatest. Space freed up by deleting
            key/data pairs from the tree is never reclaimed,
            although it is normally made available for reuse. This
            means that the btree storage structure is grow-only.
            The only solutions are to avoid excessive deletions, or
            to create a fresh tree periodically from a scan of an
            existing one. Searches, insertions, and deletions in a
            btree will all complete in O lg base N where base is
            the average fill factor. Often, inserting ordered data
            into btrees results in a low fill factor. This
            implementation has been modified to make ordered
            insertion the best case, resulting in a much better
            than normal page fill factor.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="btree-3_sect2" name="btree-3_sect2" shape="rect"> </a>

      <h2>ERRORS</h2>

      <p>The <code class="function">btree</code> access method
      routines may fail and set <code class="varname">errno</code>
      for any of the errors specified for the library routine
      <a class="link" href="../htmlman3/dbopen.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dbopen</span>(3)</span></a>.</p>
    </div>

    <div class="refsect1">
      <a id="btree-3_sect3" name="btree-3_sect3" shape="rect"> </a>

      <h2>BUGS</h2>

      <p>Only big and little endian byte order is supported.</p>
    </div>

    <div class="refsect1">
      <a id="btree-3_sect4" name="btree-3_sect4" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman3/dbopen.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dbopen</span>(3)</span></a>, <a class="link" href="../htmlman3/hash.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">hash</span>(3)</span></a>, <a class="link" href="../htmlman3/mpool.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">mpool</span>(3)</span></a>, <a class="link" href="../htmlman3/recno.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recno</span>(3)</span></a></p>

      <p><span class="emphasis"><em>The Ubiquitous
      B-tree</em></span>, Douglas Comer, ACM Comput. Surv. 11, 2
      (June 1979), 121-138.</p>

      <p><span class="emphasis"><em>Prefix B-trees</em></span>,
      Bayer and Unterauer, ACM Transactions on Database Systems,
      Vol. 2, 1 (March 1977), 11-26.</p>

      <p><span class="emphasis"><em>The Art of Computer Programming
      Vol. 3: Sorting and Searching</em></span>, D.E. Knuth, 1968,
      pp 471-480.</p>
    </div>

    <div class="colophon">
      <a id="btree-3_sect5" name="btree-3_sect5" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.45 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, and information about reporting
      bugs, can be found at
      http://www.kernel.org/doc/man-pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 1990, 1993<br />

                  The Regents of the University of California.  All rights reserved.<br />

                  <br />
                  Redistribution and use in source and binary forms, with or without<br />

                  modification, are permitted provided that the following conditions<br />

                  are met:<br />
                  1. Redistributions of source code must retain the above copyright<br />

                     notice, this list of conditions and the following disclaimer.<br />

                  2. Redistributions in binary form must reproduce the above copyright<br />

                     notice, this list of conditions and the following disclaimer in the<br />

                     documentation and/or other materials provided with the distribution.<br />

                  3. All advertising materials mentioning features or use of this software<br />

                     must display the following acknowledgement:<br />

                  This product includes software developed by the University of<br />

                  California, Berkeley and its contributors.<br />

                  4. Neither the name of the University nor the names of its contributors<br />

                     may be used to endorse or promote products derived from this software<br />

                     without specific prior written permission.<br />

                  <br />
                  THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND<br />

                  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<br />

                  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<br />

                  ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE<br />

                  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br />

                  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS<br />

                  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)<br />

                  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br />

                  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY<br />

                  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF<br />

                  SUCH DAMAGE.<br />
                  <br />
                  <script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>(#)btree.3
                  8.4 (Berkeley) 8/18/94<br />
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
