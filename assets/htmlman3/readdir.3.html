<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>readdir(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="readdir(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry" title="readdir(3) — Linux manual pages">
    <a id="readdir.3" name="readdir.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>readdir, readdir_r — read a directory</p>
    </div>

    <div class="refsynopsisdiv" title="Synopsis">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;dirent.h&gt;
</pre>

        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">struct dirent
            *<strong>readdir</strong>(</code></td>

            <td rowspan="1" colspan="1">DIR *<var class="pdparam">dirp</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>readdir_r</strong>(</code></td>

            <td rowspan="1" colspan="1">DIR *<var class="pdparam">dirp</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct dirent *<var class="pdparam">entry</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct dirent **<var class="pdparam">result</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">readdir_r</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 1 || <code class="constant">_XOPEN_SOURCE</code> ||
                      <code class="constant">_BSD_SOURCE</code> ||
                      <code class="constant">_SVID_SOURCE</code> ||
                      <code class="constant">_POSIX_SOURCE</code></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1" title="DESCRIPTION">
      <a id="readdir-3_sect1" name="readdir-3_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The <code class="function">readdir</code>() function
      returns a pointer to a <span class="structname">dirent</span>
      structure representing the next directory entry in the
      directory stream pointed to by <em class="parameter"><code>dirp</code></em>. It returns NULL on
      reaching the end of the directory stream or if an error
      occurred.</p>

      <p>On Linux, the <span class="structname">dirent</span>
      structure is defined as follows:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>

              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>

                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">dirent</span> {</td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">ino_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_ino</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* inode number */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">off_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_off</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* offset to the next dirent */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_reclen</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* length of this record */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned char</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_type</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* type of file; not supported<br />

                      by all file system types */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">char</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_name</code></em>[256];</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* filename */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>

      <p>The only fields in the <span class="structname">dirent</span> structure that are mandated by
      POSIX.1 are: <em class="parameter"><code>d_name</code></em>[], of unspecified size,
      with at most <code class="constant">NAME_MAX</code>
      characters preceding the terminating null byte; and (as an
      XSI extension) <em class="parameter"><code>d_ino</code></em>.
      The other fields are unstandardized, and not present on all
      systems; see NOTES below for some further details.</p>

      <p>The data returned by <code class="function">readdir</code>() may be overwritten by subsequent
      calls to <code class="function">readdir</code>() for the same
      directory stream.</p>

      <p>The <code class="function">readdir_r</code>() function is
      a reentrant version of <code class="function">readdir</code>(). It reads the next directory
      entry from the directory stream <em class="parameter"><code>dirp</code></em>, and returns it in the
      caller-allocated buffer pointed to by <em class="parameter"><code>entry</code></em>. (See NOTES for
      information on allocating this buffer.) A pointer to the
      returned item is placed in *<em class="parameter"><code>result</code></em>; if the end of the
      directory stream was encountered, then NULL is instead
      returned in *<em class="parameter"><code>result</code></em>.</p>
    </div>

    <div class="refsect1" title="RETURN VALUE">
      <a id="readdir-3_sect2" name="readdir-3_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On success, <code class="function">readdir</code>()
      returns a pointer to a <span class="structname">dirent</span>
      structure. (This structure may be statically allocated; do
      not attempt to <a class="link" href="../htmlman3/malloc.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">free</span>(3)</span></a> it.) If the end of
      the directory stream is reached, NULL is returned and
      <code class="varname">errno</code> is not changed. If an
      error occurs, NULL is returned and <code class="varname">errno</code> is set appropriately.</p>

      <p>The <code class="function">readdir_r</code>() function
      returns 0 on success. On error, it returns a positive error
      number (listed under ERRORS). If the end of the directory
      stream is reached, <code class="function">readdir_r</code>()
      returns 0, and returns NULL in *<em class="parameter"><code>result</code></em>.</p>
    </div>

    <div class="refsect1" title="ERRORS">
      <a id="readdir-3_sect3" name="readdir-3_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl>
          <dt><span class="term"><span class="errorname">EBADF</span></span></dt>

          <dd>
            <p>Invalid directory stream descriptor <em class="parameter"><code>dirp</code></em>.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1" title="CONFORMING TO">
      <a id="readdir-3_sect4" name="readdir-3_sect4" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>SVr4, 4.3BSD, POSIX.1-2001.</p>
    </div>

    <div class="refsect1" title="NOTES">
      <a id="readdir-3_sect5" name="readdir-3_sect5" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>Only the fields <em class="parameter"><code>d_name</code></em> and <em class="parameter"><code>d_ino</code></em> are specified in
      POSIX.1-2001. The remaining fields are available on many, but
      not all systems. Under glibc, programs can check for the
      availability of the fields not defined in POSIX.1 by testing
      whether the macros <code class="constant">_DIRENT_HAVE_D_NAMLEN</code>, <code class="constant">_DIRENT_HAVE_D_RECLEN</code>, <code class="constant">_DIRENT_HAVE_D_OFF</code>, or <code class="constant">_DIRENT_HAVE_D_TYPE</code> are defined.</p>

      <p>Other than Linux, the <em class="parameter"><code>d_type</code></em> field is available
      mainly only on BSD systems. This field makes it possible to
      avoid the expense of calling <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lstat</span>(2)</span></a> if further actions
      depend on the type of the file. If the <code class="constant">_BSD_SOURCE</code> feature test macro is defined,
      then glibc defines the following macro constants for the
      value returned in <em class="parameter"><code>d_type</code></em>:</p>

      <div class="variablelist">
        <dl>
          <dt><span class="term"><code class="constant">DT_BLK</code></span></dt>

          <dd>
            <p>This is a block device.</p>
          </dd>

          <dt><span class="term"><code class="constant">DT_CHR</code></span></dt>

          <dd>
            <p>This is a character device.</p>
          </dd>

          <dt><span class="term"><code class="constant">DT_DIR</code></span></dt>

          <dd>
            <p>This is a directory.</p>
          </dd>

          <dt><span class="term"><code class="constant">DT_FIFO</code></span></dt>

          <dd>
            <p>This is a named pipe (FIFO).</p>
          </dd>

          <dt><span class="term"><code class="constant">DT_LNK</code></span></dt>

          <dd>
            <p>This is a symbolic link.</p>
          </dd>

          <dt><span class="term"><code class="constant">DT_REG</code></span></dt>

          <dd>
            <p>This is a regular file.</p>
          </dd>

          <dt><span class="term"><code class="constant">DT_SOCK</code></span></dt>

          <dd>
            <p>This is a UNIX domain socket.</p>
          </dd>

          <dt><span class="term"><code class="constant">DT_UNKNOWN</code></span></dt>

          <dd>
            <p>The file type is unknown.</p>
          </dd>
        </dl>
      </div>

      <p>If the file type could not be determined, the value
      <code class="constant">DT_UNKNOWN</code> is returned in
      <em class="parameter"><code>d_type</code></em>.</p>

      <p>Currently, only some file systems (among them: Btrfs,
      ext2, ext3, and ext4) have full support for returning the
      file type in <em class="parameter"><code>d_type</code></em>.
      All applications must properly handle a return of
      <code class="constant">DT_UNKNOWN</code>.</p>

      <p>Since POSIX.1 does not specify the size of the <em class="parameter"><code>d_name</code></em> field, and other
      nonstandard fields may precede that field within the
      <span class="structname">dirent</span> structure, portable
      applications that use <code class="function">readdir_r</code>() should allocate the buffer
      whose address is passed in <em class="parameter"><code>entry</code></em> as follows:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
name_max = pathconf(dirpath, _PC_NAME_MAX);
if (name_max == −1)         /* Limit not defined, or error */
    name_max = 255;         /* Take a guess */
len = offsetof(struct dirent, d_name) + name_max + 1;
entryp = malloc(len);
</pre>
          </div>
        </blockquote>
      </div>

      <p>(POSIX.1 requires that <em class="parameter"><code>d_name</code></em> is the last field in a
      <span class="emphasis"><em>struct dirent</em></span>.)</p>
    </div>

    <div class="refsect1" title="SEE ALSO">
      <a id="readdir-3_sect6" name="readdir-3_sect6" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/getdents.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getdents</span>(2)</span></a>, <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a>, <a class="link" href="../htmlman3/closedir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">closedir</span>(3)</span></a>, <a class="link" href="../htmlman3/dirfd.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dirfd</span>(3)</span></a>, <a class="link" href="../htmlman3/ftw.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ftw</span>(3)</span></a>, <a class="link" href="../htmlman3/offsetof.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">offsetof</span>(3)</span></a>, <a class="link" href="../htmlman3/opendir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">opendir</span>(3)</span></a>, <a class="link" href="../htmlman3/rewinddir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">rewinddir</span>(3)</span></a>, <a class="link" href="../htmlman3/scandir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">scandir</span>(3)</span></a>, <a class="link" href="../htmlman3/seekdir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">seekdir</span>(3)</span></a>, <a class="link" href="../htmlman3/telldir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">telldir</span>(3)</span></a></p>
    </div>

    <div class="colophon" title="COLOPHON">
      <a id="readdir-3_sect7" name="readdir-3_sect7" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.42 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, and information about reporting
      bugs, can be found at
      http://www.kernel.org/doc/man-pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (C) 1993 David Metcalfe (david<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>prism.demon.co.uk)<br />

                  <br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  <br />
                  References consulted:<br />
                      Linux libc source code<br />

                      Lewine's _POSIX Programmer's Guide_ (O'Reilly &amp; Associates, 1991)<br />

                      386BSD man pages<br />

                  Modified Sat Jul 24 16:09:49 1993 by Rik Faith (faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu)<br />

                  Modified 11 June 1995 by Andries Brouwer (aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl)<br />

                  Modified 22 July 1996 by Andries Brouwer (aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl)<br />

                  2007-07-30 Ulrich Drepper &lt;drepper<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>redhat.com&gt;, mtk:<br />

                      Rework discussion of nonstandard structure fields.<br />

                  2008-09-11, mtk, Document readdir_r().<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
